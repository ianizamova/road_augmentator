# Road Scene Augmentation Pipeline

–ü—Ä–æ–µ–∫—Ç –¥–ª—è –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –¥–æ—Ä–æ–∂–Ω—ã—Ö —Å—Ü–µ–Ω —Å –ø–æ–º–æ—â—å—é –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ä–µ–¥–∫–∏—Ö –æ–±—ä–µ–∫—Ç–æ–≤ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω–æ–≥–æ –∑—Ä–µ–Ω–∏—è –∏ –≥–µ–Ω–µ—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ –ò–ò.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ä–µ–¥–∫–∏—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –∏–∑ –¥–∞—Ç–∞—Å–µ—Ç–æ–≤ (COCO)
- **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ–±—ä–µ–∫—Ç–æ–≤**: –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ —Å –ø–æ–º–æ—â—å—é –≥–µ–Ω–µ—Ä–∞—Ç–∏–≤–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π (GANs, Diffusion)
- **–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–π**: –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–æ–µ —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤ –Ω–∞ —Å—Ü–µ–Ω–µ —Å —É—á–µ—Ç–æ–º —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –∏ –≥–ª—É–±–∏–Ω—ã
- **–†–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ–µ –≤—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏–µ**: –ü—Ä–∞–≤–¥–æ–ø–æ–¥–æ–±–Ω–æ–µ –≤—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤ —Å —É—á–µ—Ç–æ–º –æ—Å–≤–µ—â–µ–Ω–∏—è –∏ –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤—ã
- **–£–ª—É—á—à–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞**: –ü–æ—Å—Ç–æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å –ø–æ–º–æ—â—å—é –¥–∏—Ñ—Ñ—É–∑–∏–æ–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π –¥–ª—è –±–µ—Å—à–æ–≤–Ω–æ–≥–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.9+
- GPU (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è) –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –º–æ–¥–µ–ª—è–º–∏

## –î–∞—Ç–∞—Å–µ—Ç—ã
–î–ª—è —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–µ–∫—Ç–∞ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–∞—Ç–∞—Å–µ—Ç—ã 
- https://github.com/bdd100k/bdd100k - –¥–ª—è —Ñ–æ–Ω–æ–≤ 
- https://www.kaggle.com/datasets/awsaf49/coco-2017-dataset - –¥–ª—è –æ–±—ä–µ–∫—Ç–æ–≤



## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
road_augmentator/
‚îú‚îÄ‚îÄ configs/                 # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
‚îÇ   ‚îú‚îÄ‚îÄ placer_config.json    # –ü—Ä–µ–¥—Å–∫–∞–∑–∞—Ç–µ–ª—å –ø–æ–∑–∏—Ü–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ inserter_config.json   # –í—Å—Ç–∞–≤–∫–∞ –æ–±—ä–µ–∫—Ç–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ enhancer_config.json   # –£–ª—É—á—à–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞
‚îú‚îÄ‚îÄ src/                       # –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥
‚îÇ   ‚îú‚îÄ‚îÄ core/                  # –ö–ª–∞—Å—Å—ã 
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ object_extractor.py    # –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ object_generator.py    # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ–±—ä–µ–∫—Ç–æ–≤
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ position_predictor.py  # –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–π
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ inserter.py            # –í—Å—Ç–∞–≤–∫–∞ –æ–±—ä–µ–∫—Ç–æ–≤
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ enhancer.py            # –£–ª—É—á—à–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞
‚îÇ   ‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ augment_dataset.py    #  –ó–∞–ø—É—Å–∫ –ø–∞–π–ø–ª–∞–π–Ω–∞
‚îÇ   ‚îî‚îÄ‚îÄ utils/                    # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã
‚îÇ       ‚îú‚îÄ‚îÄ image_utils.py            # —Ä–∞–±–æ—Ç–∞ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏
‚îÇ       ‚îú‚îÄ‚îÄ bdd100k_load.py           # –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞ —Å —Ñ–æ–Ω–∞–º–∏
‚îÇ       ‚îî‚îÄ‚îÄ coco_load.py              # –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞ —Å –æ–±—ä–µ–∫—Ç–∞–º–∏
‚îú‚îÄ‚îÄ tests/                 # —Ç–µ—Å—Ç—ã (—Ç—É—Ç –Ω–µ —Ç–µ —Ç–µ—Å—Ç—ã)
‚îÇ   ‚îú‚îÄ‚îÄ test_efficientvit.py     # —Ç–µ—Å—Ç —Å–µ–≥–º–µ–Ω—Ç–∞—Ç–æ—Ä–∞ efficientvit
‚îÇ   ‚îú‚îÄ‚îÄ test_sam_clip.py         # —Ç–µ—Å—Ç —Å–µ–≥–º–µ–Ω—Ç–∞—Ç–æ—Ä–∞ SAM + –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞ CLIP
‚îÇ   ‚îî‚îÄ‚îÄ test_segmentator.py      # —Ç–µ—Å—Ç —Å–µ–≥–º–µ–Ω—Ç–∞—Ç–æ—Ä–∞
‚îî‚îÄ‚îÄ docs/                        # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (–ø–æ–∫–∞ –Ω–µ—Ç)
```


## üß™ –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –í—ã—Ä–µ–∑–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤

```python
from src.object_extractor import ObjectExtractor

extractor = ObjectExtractor("configs/extract_config.json")

if extractor.initialize():
    # –ó–∞–ø—É—Å–∫–∞–µ–º –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ
    extractor.extract_objects()
```

### –¢–æ–ª—å–∫–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–π

```python
from src.position_predictor import ObjectPlacer
from src.utils.config_loader import load_config

config = load_config("configs/object_placer_config.json")
placer = ObjectPlacer(config)

positions = placer.predict_position(background_image)
print(f"–ù–∞–π–¥–µ–Ω–æ –ø–æ–∑–∏—Ü–∏–π: {len(positions)}")
```

### –ö–∞—Å—Ç–æ–º–Ω–∞—è –≤—Å—Ç–∞–≤–∫–∞ –æ–±—ä–µ–∫—Ç–æ–≤

```python
from src.object_inserter import ObjectInserter

inserter = ObjectInserter(config)
result, mask = inserter.insert_object(
    background, 
    foreground_object, 
    position, 
    depth_value
)
```
### –û—Å–Ω–æ–≤–Ω–æ–π –ø–∞–π–ø–ª–∞–π–Ω 

–û—Å–Ω–æ–≤–Ω–æ–π –ø–∞–π–ø–ª–∞–π–Ω —Å–µ–π—á–∞—Å –æ–ø–∏—Å–∞–Ω –≤ —Ñ–∞–π–ª–µ scripts/augment_dataset.py

```bash
cd road_augmentator
python3 src/scripts/augment_dataset.py --backgrounds_dir="/path/to/backgrounds" --objects_dir="/path/to/objects" --output_dir="/path/to/output"
```

## üìä –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –º–æ–¥–µ–ª–∏

### –°–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è
- **facebook/maskformer-swin-large-coco** - —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∞—è —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è
- **Intel/dpt-large** - –æ—Ü–µ–Ω–∫–∞ –≥–ª—É–±–∏–Ω—ã

### –ì–µ–Ω–µ—Ä–∞—Ç–∏–≤–Ω—ã–µ –º–æ–¥–µ–ª–∏
- **stabilityai/stable-diffusion-2-1-base** - —É–ª—É—á—à–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- **stabilityai/stable-diffusion-2-inpainting** - inpainting –º–æ–¥–µ–ª—å –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ


- [Hugging Face Transformers](https://huggingface.co/docs/transformers)
- [Stable Diffusion Documentation](https://huggingface.co/docs/diffusers/index)
